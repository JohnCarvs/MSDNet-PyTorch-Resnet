import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import os


plt.style.use('classic')
# plt.rcParams['font.family'] = 'serif'
# plt.rcParams['font.serif'] = 'Ubuntu'
# plt.rcParams['font.monospace'] = 'Ubuntu Mono'
plt.rcParams['font.size'] = 8

max_y = 15
max_x = 5e8
fig, ax = plt.subplots(figsize=(6, 5))

ls = [':']
color = ['#008fd5', '#fc4f30',
         '#33AD0F', '#7ECEFD',
         'b', '#DC6257',
         '#2495e2', '#FFCC12', 'r']


def plot(x, y, label=None, accumulated=False, linestyle='-', linewidth=2, isError=False,
         isPercentage=False, alpha=1., color=None, marker=None, edgecolor=None, step=False, zorder=None):
    if accumulated:
        for i in range(1, len(x)):
            x[i] += x[i - 1]
    if isPercentage:
        y = [100 * e for e in y]
    if isError:
        y = [100 - e for e in y]
    if step:
        x = [0] + x
        y = [0] + y
        x = np.array(x) / 2
        return ax.step(x, y, where='post', label=label, linestyle=linestyle, linewidth=linewidth, alpha=alpha, color=color,
                marker=marker, markersize=6, zorder=zorder)
    else:
        x = np.array(x) / 2
        return ax.plot(x, y, label=label, linestyle=linestyle, linewidth=linewidth, alpha=alpha, color=color,
                marker=marker, markersize=6, zorder=zorder)


"""
    Ours

"""

flops = [12394475.46, 12684183.2224, 12937157.7032, 13123792.9032, 13358432.0844, 13643361.674, 13881760.6336, 14198008.5016, 14544084.2896, 14850978.246, 15222297.5796, 15520224.4116, 15816035.17, 16204506.5424, 16556577.5144, 16869549.088, 17128475.962, 17498896.4972, 17888440.17, 18236529.4428, 18519491.2228, 18972985.1604, 19513483.0372, 19816409.558, 20210443.7928, 20742562.9568, 21255516.5972, 21681927.1472, 22203708.4244, 22729272.1152, 23039445.2504, 23354973.5908, 23773352.5728, 24279753.4836, 24682140.6476, 25323717.0888, 25893087.0328, 26399468.1928, 26997480.0524, 27632862.4288, 28178720.998, 28665799.8904, 29220995.364, 29686050.0916, 30058046.3028, 30691867.4076, 31346315.8672, 31911431.5744, 32366523.6824, 32846071.498, 33407697.2208, 33907772.9508, 34460755.654, 35179254.6284, 35751081.8988, 36248928.256, 36770178.3168, 37421424.5436, 37886314.4048, 38297947.4044, 38851721.094, 39462306.6508, 40027561.4408, 40513056.5672, 40962364.4376, 41618869.1728, 42250224.3156, 42635134.9312, 43251763.95, 43665080.7016, 44120292.5464, 44593819.94, 45073678.1424, 45533357.914, 46098641.2312, 46530998.6872, 46897852.9784, 47451097.6496, 48047682.238, 48516989.0044, 48963469.9092, 49404731.948, 49895758.1204, 50352645.4864, 50748494.3252, 51372896.2332, 51900209.102, 52405814.0848, 52784726.7728, 53281481.0788, 53738862.9032, 54215356.3452, 54670346.2692, 55179687.9904, 55680773.884, 56087211.0576, 56579600.0256, 56908833.7568, 57391666.784, 57827903.3504, 58283985.4664, 58692222.8396, 59285127.3392, 59683376.8548, 59994619.6876, 60498231.0772, 60708110.3376, 61301196.7108, 61726435.6608, 62098756.1176, 62464259.538, 62801214.5912, 63173452.6148, 63458937.1472, 63892013.8668, 64308954.1984, 64652587.2052, 65066691.7948, 65336045.0216, 65643505.036, 65972915.1536, 66241070.856, 66691865.9364, 67107295.6132, 67409357.6316, 67669982.662, 67974325.6204, 68347408.5364, 68707909.5244, 69001132.386, 69318466.554, 69603507.2448, 69845603.582, 70265660.9696, 70581164.072, 70774519.7524, 71181556.8576, 71434039.3596, 71711463.7968]
acc = [0.6242, 0.6261, 0.6286, 0.6301, 0.6322, 0.6345, 0.6374, 0.6394, 0.6419, 0.6434, 0.6453, 0.6477, 0.6495, 0.6509, 0.6529, 0.654, 0.6557, 0.6576, 0.6596, 0.6603, 0.6627, 0.6645, 0.6661, 0.6677, 0.6688, 0.671, 0.6736, 0.6753, 0.678, 0.6792, 0.6797, 0.6811, 0.6826, 0.684, 0.685, 0.6866, 0.6872, 0.6889, 0.69, 0.692, 0.6943, 0.6951, 0.6965, 0.6977, 0.6989, 0.7009, 0.7027, 0.7032, 0.7049, 0.706, 0.7064, 0.7078, 0.709, 0.7108, 0.7123, 0.7132, 0.7147, 0.7161, 0.7165, 0.717, 0.7176, 0.7187, 0.7193, 0.7195, 0.7208, 0.7216, 0.723, 0.7239, 0.7247, 0.7246, 0.7249, 0.7255, 0.7266, 0.7269, 0.7277, 0.7281, 0.7286, 0.7292, 0.73, 0.7295, 0.7296, 0.7296, 0.7297, 0.7303, 0.7302, 0.7309, 0.7308, 0.7317, 0.732, 0.7327, 0.7329, 0.7325, 0.7325, 0.733, 0.7334, 0.7341, 0.7343, 0.7343, 0.7347, 0.735, 0.7351, 0.7352, 0.7353, 0.7355, 0.7358, 0.7359, 0.736, 0.7362, 0.7364, 0.7365, 0.7366, 0.7368, 0.737, 0.7373, 0.7375, 0.7376, 0.738, 0.7377, 0.7376, 0.7378, 0.7382, 0.7382, 0.7388, 0.7389, 0.7391, 0.7392, 0.7392, 0.7395, 0.7396, 0.7397, 0.7397, 0.7397, 0.7397, 0.7397, 0.7397, 0.7398, 0.7399, 0.7399, 0.7399]
plot(flops[::8] + [flops[-1]], acc[::8] + [acc[-1]], label='MSDNet with dynamic evaluation', isPercentage=True, color='#000000')


flops =  [12394475.46, 12684183.2224, 12937157.7032, 13123792.9032, 13358432.0844, 13643361.674, 13881760.6336, 14198008.5016, 14544084.2896, 14850978.246, 15222297.5796, 15520224.4116, 15816035.17, 16204506.5424, 16556577.5144, 16869549.088, 17128475.962, 17498896.4972, 17888440.17, 18236529.4428, 18519491.2228, 18972985.1604, 19513483.0372, 19816409.558, 20210443.7928, 20742562.9568, 21255516.5972, 21681927.1472, 22203708.4244, 22729272.1152, 23039445.2504, 23354973.5908, 23773352.5728, 24279753.4836, 24682140.6476, 25323717.0888, 25893087.0328, 26399468.1928, 26997480.0524, 27632862.4288, 28178720.998, 28665799.8904, 29220995.364, 29686050.0916, 30058046.3028, 30691867.4076, 31346315.8672, 31911431.5744, 32366523.6824, 32846071.498, 33407697.2208, 33907772.9508, 34460755.654, 35179254.6284, 35751081.8988, 36248928.256, 36770178.3168, 37421424.5436, 37886314.4048, 38297947.4044, 38851721.094, 39462306.6508, 40027561.4408, 40513056.5672, 40962364.4376, 41618869.1728, 42250224.3156, 42635134.9312, 43251763.95, 43665080.7016, 44120292.5464, 44593819.94, 45073678.1424, 45533357.914, 46098641.2312, 46530998.6872, 46897852.9784, 47451097.6496, 48047682.238, 48516989.0044, 48963469.9092, 49404731.948, 49895758.1204, 50352645.4864, 50748494.3252, 51372896.2332, 51900209.102, 52405814.0848, 52784726.7728, 53281481.0788, 53738862.9032, 54215356.3452, 54670346.2692, 55179687.9904, 55680773.884, 56087211.0576, 56579600.0256, 56908833.7568, 57391666.784, 57827903.3504, 58283985.4664, 58692222.8396, 59285127.3392, 59683376.8548, 59994619.6876, 60498231.0772, 60708110.3376, 61301196.7108, 61726435.6608, 62098756.1176, 62464259.538, 62801214.5912, 63173452.6148, 63458937.1472, 63892013.8668, 64308954.1984, 64652587.2052, 65066691.7948, 65336045.0216, 65643505.036, 65972915.1536, 66241070.856, 66691865.9364, 67107295.6132, 67409357.6316, 67669982.662, 67974325.6204, 68347408.5364, 68707909.5244, 69001132.386, 69318466.554, 69603507.2448, 69845603.582, 70265660.9696, 70581164.072, 70774519.7524, 71181556.8576, 71434039.3596, 71711463.7968, 72007399.92, 72380963.0308, 72671276.4936, 72863796.058, 73106714.2476, 73431852.5756, 73690344.5252, 74070130.228, 74433386.8636, 74766150.2216, 74965435.66, 75172291.8176, 75405762.1424, 75652690.5584, 75962852.3144, 76214595.3972, 76390471.6448, 76568614.5688, 76813802.1784, 76980739.8288, 77228262.6892, 77412361.1548, 77577851.2376, 77851322.5028, 78119893.5196, 78310231.5844, 78550351.3356, 78682256.4636, 78978218.3704, 79159592.0544, 79434841.0248, 79678609.594, 79811584.2788, 80016031.5288, 80205937.272, 80367073.132, 80592179.0076, 80771601.8892, 80987075.2828, 81191036.3052, 81339684.1904, 81521806.07, 81698012.4552, 81951205.8492, 82118953.832, 82364710.5072, 82577792.0004, 82728416.4716, 82881631.724, 83064785.8568, 83230068.2824, 83396391.7376, 83625391.392, 83751784.82, 83865414.4464, 84133789.326, 84277664.9304, 84481276.0644, 84593429.596, 84682006.3268, 84871824.1496]
acc =  [0.6242, 0.6261, 0.6286, 0.6301, 0.6322, 0.6345, 0.6374, 0.6394, 0.6419, 0.6434, 0.6453, 0.6477, 0.6495, 0.6509, 0.6529, 0.654, 0.6557, 0.6576, 0.6596, 0.6603, 0.6627, 0.6645, 0.6661, 0.6677, 0.6688, 0.671, 0.6736, 0.6753, 0.678, 0.6792, 0.6797, 0.6811, 0.6826, 0.684, 0.685, 0.6866, 0.6872, 0.6889, 0.69, 0.692, 0.6943, 0.6951, 0.6965, 0.6977, 0.6989, 0.7009, 0.7027, 0.7032, 0.7049, 0.706, 0.7064, 0.7078, 0.709, 0.7108, 0.7123, 0.7132, 0.7147, 0.7161, 0.7165, 0.717, 0.7176, 0.7187, 0.7193, 0.7195, 0.7208, 0.7216, 0.723, 0.7239, 0.7247, 0.7246, 0.7249, 0.7255, 0.7266, 0.7269, 0.7277, 0.7281, 0.7286, 0.7292, 0.73, 0.7295, 0.7296, 0.7296, 0.7297, 0.7303, 0.7302, 0.7309, 0.7308, 0.7317, 0.732, 0.7327, 0.7329, 0.7325, 0.7325, 0.733, 0.7334, 0.7341, 0.7343, 0.7343, 0.7347, 0.735, 0.7351, 0.7352, 0.7353, 0.7355, 0.7358, 0.7359, 0.736, 0.7362, 0.7364, 0.7365, 0.7366, 0.7368, 0.737, 0.7373, 0.7375, 0.7376, 0.738, 0.7377, 0.7376, 0.7378, 0.7382, 0.7382, 0.7388, 0.7389, 0.7391, 0.7392, 0.7392, 0.7395, 0.7396, 0.7397, 0.7397, 0.7397, 0.7397, 0.7397, 0.7397, 0.7398, 0.7399, 0.7399, 0.7399, 0.74, 0.74, 0.7399, 0.7399, 0.74, 0.74, 0.7401, 0.7401, 0.7401, 0.7402, 0.7402, 0.7402, 0.7402, 0.7402, 0.7402, 0.7402, 0.7402, 0.7402, 0.7402, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403, 0.7403]
flops[-1] += 2e7
plot(flops[::8] + [flops[-1]], acc[::8] + [acc[-1]], isPercentage=True, color='#000000', alpha=0.5)


flops =  [72956570.574, 74372021.2932, 76220681.2772, 77935117.574, 78968006.222, 80351949.1792, 82139700.1384, 83894917.6536, 85595137.8832, 87273552.898, 88589185.6268, 90090297.946, 91831225.7608, 93347338.912, 94778881.6464, 96420664.3212, 98082779.6512, 99969515.448, 101583254.6652, 103189774.1952, 104864998.246, 106475012.8544, 108009664.8376, 109680312.69, 111416900.0708, 113146119.3608, 115004261.0864, 116504193.2192, 118200420.8164, 119784245.1308, 121412214.6348, 123234157.4008, 124655193.6276, 126306777.0, 127499903.3924, 128818549.998, 130227734.8872, 131463321.9592, 132614277.0232, 134119170.4536, 135276136.0492, 136513935.4756, 137840455.8992, 139068744.456, 140393506.2508, 141639400.7992, 142878960.0232, 144331980.4444, 145518950.5736, 146758129.3392, 147976189.4808, 148937684.3964, 150122798.5668, 151369349.1844, 152831450.0404, 154015357.8788, 155265589.8564, 156495756.0168, 157454351.5988, 158558143.2868, 159843534.6204, 160893689.618, 161850954.8416, 162981900.9204, 164149953.3176, 165052972.9004, 166243388.0728, 167329577.4704, 168292343.4236, 169227162.7384, 169983345.2228, 170846336.0112, 171825915.9732, 172608598.164, 173609579.5848, 174540787.224, 175627822.312, 176411460.2196, 177090289.0408, 178226975.1316, 178715535.308, 179351197.2844]
acc =  [0.7411, 0.7434, 0.7448, 0.7457, 0.7459, 0.7473, 0.7488, 0.7499, 0.7509, 0.7518, 0.7525, 0.7533, 0.7544, 0.7549, 0.7561, 0.7567, 0.7575, 0.7583, 0.7587, 0.7594, 0.7598, 0.7603, 0.7605, 0.7608, 0.7611, 0.7617, 0.7622, 0.7623, 0.7629, 0.7633, 0.7633, 0.7632, 0.7634, 0.7635, 0.7638, 0.7643, 0.7645, 0.7645, 0.7647, 0.7647, 0.7646, 0.7645, 0.7645, 0.7645, 0.7645, 0.7649, 0.765, 0.7651, 0.7652, 0.7653, 0.7653, 0.7653, 0.7654, 0.7651, 0.7652, 0.7653, 0.7653, 0.7653, 0.7653, 0.765, 0.7652, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653]
flops[-1] += 3.2e7

acc[0] -= 0.001
plot(flops[::8] + [flops[-1]], acc[::8] + [acc[-1]], isPercentage=True, color='#000000')
flops =  [12438788.0624, 12568198.9652, 12777267.474, 13038382.816, 13424240.968, 13641677.33, 13968083.5488, 14199356.0128, 14558417.3708, 14806096.6888, 15148860.0452, 15466889.9792, 15872670.2496, 16365762.1276, 16674629.322, 17126482.3272, 17512416.9892, 18017348.6984, 18650631.8808, 19116826.8676, 19624891.34, 20047187.3316, 20439071.1376, 20943252.2348, 21686018.0108, 22384591.2188, 23203200.7988, 23841088.3472, 24274512.3004, 25126749.8956, 25787113.9792, 26724957.5712, 27348302.59, 28022749.6456, 29005183.8084, 30196573.15, 30996320.204, 31958953.632, 33012457.1224, 33943892.1052, 34791015.1036, 35629092.1036, 36855926.3736, 37796123.4896, 38902251.8984, 40091027.2476, 41183145.9192, 42129710.8116, 43466710.1012, 44901212.6728, 46274705.1008, 47649055.466, 49028706.9292, 50469899.5888, 51776730.0076, 53116970.398, 54752321.9632, 56195821.54, 57323460.1016, 58911158.176, 60042503.354, 61698634.5668, 63428145.1876, 64944155.2084, 66338459.9756, 67431122.928, 69423337.9968, 70936369.314, 72956570.574, 74372021.2932, 76220681.2772, 77935117.574, 78968006.222, 80351949.1792, 82139700.1384, 83894917.6536, 85595137.8832, 87273552.898, 88589185.6268, 90090297.946, 91831225.7608, 93347338.912, 94778881.6464, 96420664.3212, 98082779.6512, 99969515.448, 101583254.6652, 103189774.1952, 104864998.246, 106475012.8544, 108009664.8376, 109680312.69, 111416900.0708, 113146119.3608, 115004261.0864, 116504193.2192, 118200420.8164, 119784245.1308, 121412214.6348, 123234157.4008, 124655193.6276, 126306777.0, 127499903.3924, 128818549.998, 130227734.8872, 131463321.9592, 132614277.0232, 134119170.4536, 135276136.0492, 136513935.4756, 137840455.8992, 139068744.456, 140393506.2508, 141639400.7992, 142878960.0232, 144331980.4444, 145518950.5736, 146758129.3392, 147976189.4808, 148937684.3964, 150122798.5668, 151369349.1844, 152831450.0404, 154015357.8788, 155265589.8564, 156495756.0168, 157454351.5988, 158558143.2868, 159843534.6204, 160893689.618, 161850954.8416, 162981900.9204, 164149953.3176, 165052972.9004, 166243388.0728, 167329577.4704, 168292343.4236, 169227162.7384, 169983345.2228, 170846336.0112, 171825915.9732, 172608598.164, 173609579.5848, 174540787.224, 175627822.312, 176411460.2196, 177090289.0408, 178226975.1316, 178715535.308, 179351197.2844, 180352488.6588, 181100831.5616, 181829263.496, 182880562.7272, 183711223.3604, 184487446.0768, 185262870.3504, 186126573.2896, 186798468.4532, 187385915.3244, 187935027.8152, 188475684.0104, 189123124.5292, 189879454.8468, 190720647.6584, 191250915.9704, 191861958.1668, 192496844.0172, 193132087.0188, 193710624.8752, 194223608.2196, 194963669.8132, 195399920.2644, 195797459.5456, 196321687.8348, 196823407.7948, 197257108.7832, 197856893.2672, 198584252.3856, 198790773.4328, 199196999.5608, 199667473.8316, 200162654.068, 200504742.102, 201077889.756, 201456551.054, 201692776.4256, 202090040.156, 202725699.2588, 203173933.9616, 203465517.5812, 203918699.2556, 204427404.6676, 204779297.4704, 205490592.4864, 205815129.8772, 206305618.4828, 206671683.3608, 207065611.8432, 207507894.822]
acc =  [0.6161, 0.617, 0.6182, 0.62, 0.6216, 0.6229, 0.6243, 0.6252, 0.6273, 0.6287, 0.6308, 0.6331, 0.6342, 0.6364, 0.6381, 0.6402, 0.6413, 0.6436, 0.6467, 0.6499, 0.6517, 0.6552, 0.657, 0.6577, 0.6598, 0.6613, 0.6642, 0.666, 0.6685, 0.6725, 0.6734, 0.677, 0.6783, 0.6801, 0.6827, 0.6852, 0.6867, 0.6893, 0.6917, 0.6935, 0.6951, 0.6961, 0.6988, 0.7016, 0.704, 0.7066, 0.7076, 0.7086, 0.7113, 0.7133, 0.7145, 0.7157, 0.7168, 0.7193, 0.7199, 0.7213, 0.7239, 0.7255, 0.7261, 0.7284, 0.7289, 0.7304, 0.7315, 0.7318, 0.7333, 0.7345, 0.7361, 0.7384, 0.7411, 0.7434, 0.7448, 0.7457, 0.7459, 0.7473, 0.7488, 0.7499, 0.7509, 0.7518, 0.7525, 0.7533, 0.7544, 0.7549, 0.7561, 0.7567, 0.7575, 0.7583, 0.7587, 0.7594, 0.7598, 0.7603, 0.7605, 0.7608, 0.7611, 0.7617, 0.7622, 0.7623, 0.7629, 0.7633, 0.7633, 0.7632, 0.7634, 0.7635, 0.7638, 0.7643, 0.7645, 0.7645, 0.7647, 0.7647, 0.7646, 0.7645, 0.7645, 0.7645, 0.7645, 0.7649, 0.765, 0.7651, 0.7652, 0.7653, 0.7653, 0.7653, 0.7654, 0.7651, 0.7652, 0.7653, 0.7653, 0.7653, 0.7653, 0.765, 0.7652, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653, 0.7653]
flops = flops[50:]
acc = acc[50:]
flops[-1] += 4e7
plot(flops[::8] + [flops[-1]], acc[::8] + [acc[-1]], isPercentage=True, color='#000000', alpha=0.5)

flops =  [195021805.7984, 199655825.7764, 203362858.0184, 207863875.996, 213166486.0596, 218101645.028, 223280075.5292, 227076555.3788, 232540737.9904, 236846508.7288, 241355357.7636, 245593633.9068, 251008828.7492, 255054567.6584, 259276497.7856, 263479799.9008, 267947987.5416, 272177681.8656, 276111310.586, 279673987.6596, 283420418.3252, 287176932.7584, 291163566.3124, 295215595.4672, 299594679.85, 303394792.0324, 307251308.0516, 310566931.2148, 314587462.8264, 318157664.7536, 321164333.432, 324259888.53, 327494709.4376, 330552784.5344, 334107916.2252, 337532169.8276, 340932345.0452, 343568619.7824, 346308073.4428, 349421028.9768, 352655596.3444, 355755346.7616, 359253253.13, 361963317.6344, 364580581.6692, 367255855.098, 369454475.8536, 372292363.1636, 374677829.4644, 377664058.6756, 379933892.6008, 382222675.8272, 384530249.1776, 386822182.9548, 389235913.9556, 391379327.2208, 393913583.4764, 395928388.5268, 397972793.6696, 399969137.9256, 401720761.6812, 403528689.952]
acc =  [0.7629, 0.7635, 0.7639, 0.7642, 0.7657, 0.7668, 0.7681, 0.7676, 0.7677, 0.7677, 0.7683, 0.7688, 0.7695, 0.7701, 0.7703, 0.7703, 0.7706, 0.7706, 0.7704, 0.7705, 0.7707, 0.7706, 0.7707, 0.7709, 0.7712, 0.7713, 0.7712, 0.7711, 0.7712, 0.7714, 0.7715, 0.7721, 0.7722, 0.7723, 0.7726, 0.7726, 0.7727, 0.7728, 0.7727, 0.7728, 0.7728, 0.7728, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729]
flops = flops[4:]
acc = acc[4:]

plot(flops[::8] + [flops[-1]], acc[::8] + [acc[-1]], isPercentage=True, color='#000000')
flops = [12408190.5224, 12552481.3004, 12992621.264, 13275296.866, 13568594.1164, 13748475.3444, 13957605.2844, 14229372.9936, 14666811.9972, 14870318.4104, 15385603.0756, 15818258.4596, 16256602.4204, 16626618.438, 17010855.116, 17473293.64, 18451278.5836, 18589157.2, 18780466.1048, 19250210.9624, 19742954.3104, 20213032.9668, 20701489.6336, 21362708.2752, 21864841.702, 22454105.0912, 23084361.452, 23524267.4052, 24439952.1312, 25241543.0956, 25982595.7892, 26900192.3236, 27786068.3184, 28758749.2768, 29535636.9716, 31089408.6204, 32305120.2844, 33238668.0572, 34796044.9728, 36294560.6712, 37706592.6652, 38893272.7776, 40861972.5176, 42698586.4612, 44150617.0692, 45622738.4136, 47497693.974, 49994588.8704, 52205843.5132, 54612138.2808, 56714559.2712, 58991138.7464, 60909636.762, 63476053.1736, 66002272.6852, 68364844.2364, 70629001.2664, 73633794.1292, 76370865.9952, 79808645.562, 82980572.0448, 86381704.1092, 89874325.13, 92844792.3196, 95914503.2432, 98848303.2008, 102298315.3956, 105485737.6744, 108766151.9444, 112541386.682, 116818041.4528, 120717178.0172, 124554540.9088, 128734107.1968, 131831153.9912, 135578318.0576, 139563221.1532, 144252428.1004, 148481049.676, 152992796.5112, 156976606.82, 162693151.4628, 167250005.4132, 171772343.2932, 176403251.2928, 181075915.0964, 185387727.63, 190349127.2216, 195021805.7984, 199655825.7764, 203362858.0184, 207863875.996, 213166486.0596, 218101645.028, 223280075.5292, 227076555.3788, 232540737.9904, 236846508.7288, 241355357.7636, 245593633.9068, 251008828.7492, 255054567.6584, 259276497.7856, 263479799.9008, 267947987.5416, 272177681.8656, 276111310.586, 279673987.6596, 283420418.3252, 287176932.7584, 291163566.3124, 295215595.4672, 299594679.85, 303394792.0324, 307251308.0516, 310566931.2148, 314587462.8264, 318157664.7536, 321164333.432, 324259888.53, 327494709.4376, 330552784.5344, 334107916.2252, 337532169.8276, 340932345.0452, 343568619.7824, 346308073.4428, 349421028.9768, 352655596.3444, 355755346.7616, 359253253.13, 361963317.6344, 364580581.6692, 367255855.098, 369454475.8536, 372292363.1636, 374677829.4644, 377664058.6756, 379933892.6008, 382222675.8272, 384530249.1776, 386822182.9548, 389235913.9556, 391379327.2208, 393913583.4764, 395928388.5268, 397972793.6696, 399969137.9256, 401720761.6812, 403528689.952, 405444533.1796, 407061318.5456, 409059800.7512, 411229489.0348, 412892820.5032, 414647998.1444, 416156399.7288, 417862223.9804, 419581095.8476, 421666435.8064, 423108690.7808, 424884989.8468, 426169895.6636, 427457723.3944, 428841059.714, 430564570.7808, 431994179.6724, 433158618.5576, 434441903.3112, 435619426.7172, 437188535.978, 438832657.0552, 440397631.2156, 442121400.4976, 443003643.7104, 444660388.4136, 445805910.12, 447281178.1376, 448136884.6276, 449416050.5036, 450178935.622, 451498573.8204, 452637746.4096, 453671130.9612, 455143357.1256, 455888308.1876, 457058512.656, 458024693.3524, 459022270.0412, 459915268.2736, 461144071.5604, 462232517.536, 463335830.4856, 464219266.5572, 465136228.5088, 466090434.4592, 466738061.0408, 467645962.7564, 468277966.2536, 469346088.7776]
acc = [0.5967, 0.5966, 0.5988, 0.5999, 0.6013, 0.6023, 0.6039, 0.606, 0.6076, 0.609, 0.6112, 0.6118, 0.6132, 0.6162, 0.6188, 0.6205, 0.6233, 0.6245, 0.6254, 0.6266, 0.6285, 0.6301, 0.633, 0.6352, 0.6374, 0.6403, 0.6435, 0.6453, 0.6467, 0.6483, 0.6504, 0.6525, 0.6542, 0.6559, 0.6577, 0.6602, 0.6625, 0.664, 0.6657, 0.6695, 0.6723, 0.6736, 0.6777, 0.68, 0.6825, 0.6837, 0.6864, 0.6893, 0.6922, 0.6949, 0.698, 0.7006, 0.7033, 0.7062, 0.7092, 0.7123, 0.7151, 0.717, 0.7192, 0.7205, 0.7227, 0.7245, 0.7275, 0.7294, 0.7312, 0.7329, 0.7343, 0.7357, 0.7367, 0.7395, 0.7411, 0.7428, 0.7441, 0.7469, 0.7473, 0.7494, 0.7501, 0.7516, 0.7517, 0.7531, 0.7538, 0.756, 0.7573, 0.7593, 0.7598, 0.7606, 0.7616, 0.7622, 0.7629, 0.7635, 0.7639, 0.7642, 0.7657, 0.7668, 0.7681, 0.7676, 0.7677, 0.7677, 0.7683, 0.7688, 0.7695, 0.7701, 0.7703, 0.7703, 0.7706, 0.7706, 0.7704, 0.7705, 0.7707, 0.7706, 0.7707, 0.7709, 0.7712, 0.7713, 0.7712, 0.7711, 0.7712, 0.7714, 0.7715, 0.7721, 0.7722, 0.7723, 0.7726, 0.7726, 0.7727, 0.7728, 0.7727, 0.7728, 0.7728, 0.7728, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729, 0.7729]
flops = flops[80:100]
acc = acc[80:100]
plot(flops[::8] + [flops[-1]], acc[::8] + [acc[-1]], isPercentage=True, color='#000000', alpha=0.5)


x = [17936394,
44508360,
80593196,
110204816,
149988852,
181729368,
215313084,]
#255384864]
y = [ 37.8600,
 32.4200,
 28.9700,
 27.4100,
 25.9100,
 24.8500,
 23.9800,]
 #23.9800]
plot(x, y, label='MSDNet w/o dynamic evaluation', isError=True, color='#000000', linewidth=2, marker = 'o', linestyle="-.")

flops = [42793213.1146, 45153977.4772, 47938546.137, 51040375.3516, 54791088.4102, 59039026.4766, 64088724.3576,
         69527875.223, 75526216.4192, 82416002.2332, 89237803.9634, 98208156.5194, 107324622.8532, 116609488.577,
         126347222.316, 136873973.6312, 146894165.5662, 157116341.758, 166506526.5028, 175324170.3834, 184190772.208,
         192276521.5742, 199454592.6318, 206544101.954, 212357473.4882, 218375629.9886, 223529057.5392, 228573266.039,
         232896761.3886, 236765826.8298, 240098909.2438, 243356393.2244, 246320823.149, 249040678.3186, 251845754.4506,
         253913194.8064, 255980785.4624, 258117579.2772, 260012637.0688, 261563952.9398]
acc = [0.4534, 0.4591, 0.4653, 0.4738, 0.4815, 0.4896, 0.4994, 0.5125, 0.5244, 0.5388, 0.5536, 0.572, 0.589, 0.6063,
       0.6194, 0.6328, 0.6441, 0.6572, 0.6664, 0.6744, 0.6824, 0.6865, 0.6888, 0.6919, 0.6934, 0.6951, 0.6966, 0.6977,
       0.6984, 0.6991, 0.699, 0.6992, 0.6992, 0.6996, 0.6997, 0.6998, 0.7, 0.7, 0.7, 0.7]
plot(flops, acc, label='ResNet     with early-exits', isPercentage=True , color=color[4])


flops = [71067189.7494, 76261654.9326, 82012356.0952, 88178751.0276, 94618766.9514, 101683248.7138, 108722587.2446,
         116774946.6638, 125333784.4304, 134328418.7866, 142484954.892, 151207224.0066, 160991832.538, 169967951.4804,
         178945330.6548, 189626118.3328, 198507540.9482, 206936538.8, 214875223.1616, 221530567.833, 228337637.7434,
         234332821.4088, 240468803.8334, 244670744.6944, 249406127.6122, 253450338.9572, 256665690.6078, 259979034.5846,
         262475772.7628, 264624122.6328, 266735950.7712, 268580471.0872, 270318106.4056, 272004707.0796, 273271507.6884,
         274521117.9326, 275509098.1888, 276449965.0562, 277189264.5092, 277827771.1844]
acc = [0.578, 0.5844, 0.5924, 0.6003, 0.6064, 0.6161, 0.6234, 0.6331, 0.641, 0.649, 0.6571, 0.6663, 0.6755, 0.6802,
       0.6857, 0.6926, 0.6978, 0.7004, 0.7023, 0.7031, 0.7042, 0.7048, 0.7057, 0.7057, 0.7062, 0.7067, 0.707, 0.7072,
       0.7074, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076, 0.7076]
plot(flops, acc, label='DenseNet     with early-exits', isPercentage=True , color=color[8])



"""
Baseline

"""

flops = [8639590.0, 10131773.0802, 11067787.4082, 12722214.1362, 14005448.8732, 16685385.2508, 18726257.9924, 22295966.8618, 26069569.0142,
         30789625.2924, 36486512.5802, 44937489.8332, 54308043.293, 66120759.276, 81277390.8318, 99524163.608, 119235767.0982, 141860921.9162, 167049562.9596, 192299626.6038, 218933149.6192,
         244192810.6556, 268348380.3706, 291689329.875, 313718294.0714, 335371017.9512, 353031037.5816, 369253186.3742,
         383931377.4532, 397826691.3128, 409323862.4262, 420645282.6958, 430855776.4128, 439333234.098, 447173801.7746,
         461766980.8824, 473346556.802, 504564976.4696, 576615472.6398]
acc = [0.4702, 0.483, 0.4958, 0.5087, 0.5196, 0.5319, 0.5505, 0.5697, 0.5827, 0.5991, 0.6165, 0.6357, 0.6514, 0.6685,
       0.69, 0.7054, 0.7205, 0.7302, 0.7381, 0.745, 0.7507, 0.7517, 0.7529, 0.7543, 0.7564, 0.7574, 0.7575, 0.7577,
       0.7576, 0.7579, 0.758, 0.7579, 0.7579, 0.7579, 0.7579, 0.7579, 0.7579, 0.7579, 0.7579]


plt.scatter([5e8/2], [100-24.98], marker='*', label = 'Stochastic Depth (Huang et al., 2016)', c='m',
            s=80, edgecolor='#000000', linewidth=0.6)



ax.annotate('ResNet-110', xy=(5e8/2, 100-27.76+0.1),
            xytext=(-35, 20), textcoords='offset points',
            arrowprops=dict(arrowstyle="->", color='#000000',
                            connectionstyle="angle,angleA=0,angleB=90,rad=10")
            )

plt.scatter([167642378/2], [100-30.89], label='WideResNet (Zagoruyko et al., 2016)',
            marker='d', c='#45CEFD', s=60, edgecolor='#000000', linewidth=0.6, zorder=10)


plt.scatter([475214458/2], [100-24.4692], marker='*', c='r', s=70,
            edgecolor='#000000', linewidth=0.6)
ax.annotate('DenseNet-88', xy=(475214458/2, 100-24.4692+0.1),
    xytext=(-30, 20), textcoords='offset points',
            arrowprops=dict(arrowstyle="->", color='#000000',
                            connectionstyle="angle,angleA=0,angleB=-90,rad=10")
            )


""" baseline

"""


flops = [24700170.0, 53183754.0, 81667338.0, 110150922.0, 138634506.0, 167118090.0, 195601674.0,
         224085258.0, 252568842, 281052426, 309536010, 338019594, 366503178, 394986762, 423470346,
         451953930, 5e8]
acc = [38.72195,
34.2047,
32.43185,
31.48035,
30.4537,
30.10815,
30.0681,
29.46215,
29.357,
29.4872,
28.746,
29.2167,
28.2051,
29.5573,
28.2051,
28.6659, 27.76]
obj = plot(flops[1:len(acc):2] + [flops[-1]], acc[1:len(acc):2] + [acc[-1]], label="ResNets (He et al., 2015)", isError=True, marker='s', linestyle=ls[0], linewidth=3, color=color[4])



flops = [20010940.0, 40421092.0, 63266188.0, 88546228.0, 116261212.0, 146411140.0, 178996012.0, 214015828.0,
         291360292, 378444532, 475214458]
acc = [50.66, 38.73, 34.21, 31.28, 29.5, 28.26, 27.17, 26.7, 25.8514, 25.0801, 24.4692]

obj = plot(flops, acc, label="DenseNets (Huang et al., 2016)", isError=True, marker='H',
           linestyle=ls[0], color='r')

flops = [8644540.0, 16508644.0, 25628044.0, 36002740.0, 47632732.0, 60518020.0, 74658604.0, 90054484.0, 106705660.0, 124612132.0, 143773900.0, 164190964.0]
acc =[52.9891, 40.615, 36.8289, 33.4135, 31.28, 30.639, 29.4171, 28.4054, 27.5741, 27.1334, 27.1735, 25.8213]




acc=[100-27.4]
flops = [257163264/2]
obj = plt.scatter(flops, acc, label="FractalNet (Larsson et al., 2016)", s=70, marker='h', color='#FFCC5C',
                  edgecolor='#000000', linewidth=0.6)



ax.spines['left'].set_color('k')
ax.spines['left'].set_linewidth(0.5)
ax.spines['right'].set_color('k')
ax.spines['right'].set_linewidth(0.5)
ax.spines['top'].set_color('k')
ax.spines['top'].set_linewidth(0.5)
ax.spines['bottom'].set_color('k')
ax.spines['bottom'].set_linewidth(0.5)
ax.tick_params(axis='x', length=4)
ax.tick_params(axis='y', length=4)



plt.grid(color='#000000', alpha=0.1,linestyle='-', linewidth=0.5)

plt.ylim(60,78)
plt.xlim(0, 5.2e8/2)

ax.yaxis.set_ticks(np.arange(60, 79, 2))
# ax.set_xscale("log", nonposx='clip')

plt.tight_layout(pad=2.5, w_pad=2, h_pad=1)

plt.xlabel('average budget (in MUL-ADD)', size=12)
plt.ylabel('accuracy (%)', size=12)
plt.title('Budgeted batch classification on CIFAR-100', size=12)



plt.legend(loc=4, scatterpoints=1)
plt.savefig('early-exit-cifar100.pdf')

plt.show()